DROP DATABASE IF EXISTS ServiceTicket;
CREATE DATABASE ServiceTicket;
USE ServiceTicket;

DROP TABLE IF EXISTS EventActivity;
CREATE TABLE EventActivity (
	ID INTEGER AUTO_INCREMENT PRIMARY KEY,
	ActivityName VARCHAR(20) NOT NULL
);

DROP TABLE IF EXISTS EventOrigin;
CREATE TABLE EventOrigin (
	ID INTEGER UNIQUE,
	OriginName VARCHAR(20) NOT NULL,
	FOREIGN KEY (ID) REFERENCES EventActivity(ID)
);

DROP TABLE IF EXISTS EventStatus;
CREATE TABLE EventStatus (
	ID INTEGER UNIQUE,
	Status VARCHAR(20) NOT NULL,
	FOREIGN KEY (ID) REFERENCES EventActivity(ID)
);

DROP TABLE IF EXISTS EventClass;
CREATE TABLE EventClass (
	ID INTEGER UNIQUE,
	Class VARCHAR(20) NOT NULL,
	FOREIGN KEY (ID) REFERENCES EventActivity(ID)
);

DROP TABLE IF EXISTS EventLog;
CREATE TABLE EventLog (
	ID INTEGER UNIQUE,
	Caseid VARCHAR(20) UNIQUE NOT NULL,
	Urgency VARCHAR(1) NOT NULL,
	Impact VARCHAR(1) NOT NULL,
 	Priority VARCHAR(1) NOT NULL,
	StartDate DATE NOT NULL,
	UpdateDateTime DATETIME NOT NULL,
	Duration INTEGER NOT NULL,
	CONSTRAINT check_caseid_format CHECK (Caseid REGEXP '^CS_[0-9]+$'),
	FOREIGN KEY (ID) REFERENCES EventActivity(ID),
	FOREIGN KEY (ID) REFERENCES EventStatus(ID),
	FOREIGN KEY (ID) REFERENCES EventOrigin(ID),
	FOREIGN KEY (ID) REFERENCES EventClass(ID)
);




